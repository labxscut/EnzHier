# EnzHier

EnzHier is a tool that uses deep learning to classify enzymes from protein sequences.

## Overview

EnzHier uses protein sequence embeddings generated by ESM (Evolutionary Scale Modeling) and a neural network architecture to predict enzyme classifications. The tool analyzes protein sequences provided in FASTA format and predicts their Enzyme Commission (EC) numbers.

## Dependencies

- Python 3.7+
- PyTorch
- pandas
- scikit-learn
- numpy
- matplotlib
- seaborn
- biopython
- fair-esm (ESM protein language model)
- tqdm

## Installation

Clone the repository and install the required dependencies:

```bash
git clone https://github.com/yourusername/EnzHier.git
cd EnzHier
pip install -r requirements.txt
pip install -e .
```

For model training with GPU support, ensure you have CUDA installed.

## File Structure

- `EnzHier/` - Core package containing model implementation
  - `model.py` - Neural network architecture definition
  - `utils.py` - Utility functions for data processing
  - `infer.py` - Functions for inference
  - `dataloader.py` - Data loading functionality
  - `distance_map.py` - Distance mapping functions
- `data/` - Directory for data files
  - `model/` - Trained model checkpoints
  - `pretrained/` - Pretrained models and GMM files
  - `inputs/` - Input FASTA files for inference
- `results/` - Output directory for inference results
- `EnzHier_infer.py` - Command-line script for enzyme classification

## Usage

EnzHier allows you to classify enzyme sequences using a pre-trained model. To run inference on a FASTA file:

```bash
python EnzHier_infer.py -d your_fasta_file
```

Where `your_fasta_file` is the name of your FASTA file (without extension) located in the `data/inputs/` directory. The file should be named `your_fasta_file.fasta`.

### Inference Process

1. The script converts the FASTA file to a temporary CSV format for processing
2. It uses the ESM embedding model to generate protein embeddings
3. The LayerNormNet neural network processes these embeddings
4. Maximum separation inference is used to predict EC numbers
5. Results are saved to `results/inputs/your_fasta_file.csv`

### Pre-trained Models

The default inference uses:
- Model: `split100_triplet_withEC_7000` (located in `data/model/`)
- GMM ensemble: `gmm_ensumble.pkl` (located in `data/pretrained/`)

## Output Format

The output CSV file contains predicted EC numbers for each protein sequence along with confidence scores.

## Advanced Usage

For custom model training or advanced usage, refer to the EnzHier package modules:

- `LayerNormNet` - Neural network architecture with layer normalization
- `infer_maxsep2` - Function for maximum separation inference
- `esm_embedding` - Function to generate ESM embeddings for protein sequences

## Citation

If you use EnzHier in your research, please cite our paper:

[Paper citation information]

## License

[License information]
